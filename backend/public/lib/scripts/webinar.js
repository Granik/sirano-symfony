var updateTimerTimer,updateStartTimeTimer,updateFinishTimeTimer,stopWebinarTimer,popupTime1Timer,popupTime2Timer,popupTime3Timer,player,nowPlaying=!1,confirmBlock=$("#modal-webinar-check"),webinarOverBlock=$("#webinar-over"),webinarSoonBlock=$("#webinar-soon"),webinarPlayerBlock=$("#webinar-player"),tag=document.createElement("script");tag.src="https://www.youtube.com/player_api";var firstScriptTag=document.getElementsByTagName("script")[0];function printTimer(e,i,n){return'<div class="d-flex flex-column p-2">                <span class="count">'+e+'</span>                <span class="sub">дней</span>            </div>            <div class="d-flex flex-column p-2">                <span class="count">'+i+'</span>                <span class="sub">часов</span>            </div>            <div class="d-flex flex-column p-2">                <span class="count">'+n+'</span>                <span class="sub">минут</span>            </div>'}function showConfirm(){confirmBlock.modal("show")}function setConfirm(){$.ajax({type:"POST",cache:!1,url:webinar.confirmUrl,dataType:"json",data:{id:webinar.id},success:function(e){"ok"===e.status&&confirmBlock.modal("hide")},error:function(e,i,n){confirmBlock.modal("show")}})}function startWebinar(){if(!nowPlaying){nowPlaying=!0,webinarOverBlock.removeClass("d-flex").addClass("d-none"),webinarSoonBlock.removeClass("d-flex").addClass("d-none"),webinarPlayerBlock.removeClass("d-none").addClass("d-flex"),player=new YT.Player("player",{width:"100%",videoId:webinar.youtubeCode,events:{onReady:function(e){e.target.playVideo()}}});var e=Date.now();stopWebinarTimer=setTimeout(stopWebinar,webinar.finishTime-e),webinar.popupTime1>e&&(popupTime1Timer=setTimeout(showConfirm,webinar.popupTime1-e)),webinar.popupTime2>e&&(popupTime2Timer=setTimeout(showConfirm,webinar.popupTime2-e)),webinar.popupTime3>e&&(popupTime3Timer=setTimeout(showConfirm,webinar.popupTime3-e)),updateFinishTimeTimer=setInterval(updateFinishTime,UPDATE_INTERVAL)}}firstScriptTag.parentNode.insertBefore(tag,firstScriptTag),$("#modal-webinar-check").on("hidden.bs.modal",function(){setConfirm()});var stopWebinar=function(){nowPlaying&&(nowPlaying=!1,player.stopVideo(),clearInterval(updateFinishTimeTimer),webinarOverBlock.removeClass("d-none").addClass("d-flex"),webinarSoonBlock.removeClass("d-flex").addClass("d-none"),webinarPlayerBlock.removeClass("d-flex").addClass("d-none"))},updateTimer=function(){Date.now()<=webinar.startTime?countdown(webinar.startTime,function(e){document.getElementById("webinar-countdown").innerHTML=printTimer(e.days,e.hours,e.minutes)},countdown.DAYS|countdown.HOURS|countdown.MINUTES|countdown.SECONDS):(clearInterval(updateTimerTimer),startWebinar())},updateStartTime=function(){$.get(webinar.getTimes,{id:webinar.id},function(e){webinar.startTime=e.start_time,webinar.finishTime=e.finish_time,webinar.popupTime1=e.popup_start_time,webinar.popupTime2=e.popup_mid_time,webinar.popupTime3=e.popup_end_time,clearInterval(updateStartTimeTimer),clearInterval(updateTimerTimer),checkWebinarStatus(webinar.startTime,webinar.finishTime)})},updateFinishTime=function(){$.get(webinar.getTimes,{id:webinar.id},function(e){webinar.startTime=e.start_time,webinar.finishTime=e.finish_time,webinar.popupTime1=e.popup_start_time,webinar.popupTime2=e.popup_mid_time,webinar.popupTime3=e.popup_end_time,clearTimeout(stopWebinarTimer),clearTimeout(popupTime1Timer),clearTimeout(popupTime2Timer),clearTimeout(popupTime3Timer);var i=Date.now();stopWebinarTimer=setTimeout(stopWebinar,webinar.finishTime-i),webinar.popupTime1>i&&(popupTime1Timer=setTimeout(showConfirm,webinar.popupTime1-i)),webinar.popupTime2>i&&(popupTime2Timer=setTimeout(showConfirm,webinar.popupTime2-i)),webinar.popupTime3>i&&(popupTime3Timer=setTimeout(showConfirm,webinar.popupTime3-i))})};if(webinar.isStarted)function onYouTubeIframeAPIReady(){startWebinar()}else{var checkWebinarStatus=function(e,i){var n=Date.now();i<n?stopWebinar():e<=n?startWebinar():(updateTimerTimer=setInterval(updateTimer,1e3),updateStartTimeTimer=setInterval(updateStartTime,UPDATE_INTERVAL))};countdown(webinar.startTime,function(e){document.getElementById("webinar-countdown").innerHTML=printTimer(e.days,e.hours,e.minutes)},countdown.DAYS|countdown.HOURS|countdown.MINUTES|countdown.SECONDS),checkWebinarStatus(webinar.startTime,webinar.finishTime)}$("#webinar-message").on("submit",function(){var a=this,e=new FormData(this);return $.ajax({type:"POST",url:webinar.message,data:e,processData:!1,contentType:!1,dataType:"json",success:function(e,i,n){"ok"===e.status&&($("#modal-message-sent").modal("show"),a.reset())},error:function(e,i,n){}}),!1});